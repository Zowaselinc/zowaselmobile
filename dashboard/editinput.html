<!DOCTYPE html>
<html lang="en">
    <head>
    <script type="text/javascript"  src="../assets/js/accessauthentication_dashboard.js"></script>
	<!-- Meta -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, minimal-ui, viewport-fit=cover">
	<meta name="theme-color" content="#2196f3">
	<meta name="author" content="DexignZone" /> 
    <meta name="keywords" content="" /> 
    <meta name="robots" content="" /> 
	<meta name="description" content="Zowasel"/>
	<meta property="og:title" content="Zowasel" />
	<meta property="og:description" content="Zowasel" />
	<meta property="og:image" content="https://zowasel.com/images/logos/white%20logo.png"/>
	<meta name="format-detection" content="telephone=no">
	
    <!-- Favicons Icon -->
	<link rel="shortcut icon" type="image/x-icon" href="../logos/zowaselICO512by512.png" />
    
    <!-- Title -->
	<title>Zowasel Mobile Web</title>
	
	<!-- PWA Version -->
	<!-- <link rel="manifest" href="manifest.json"> -->
    
    <!-- Stylesheets -->
	<link rel="stylesheet" href="../assets/vendor/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.css">
    <link rel="stylesheet" href="../assets/vendor/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" type="text/css" href="../bypass.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/font.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/style.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/style2.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/stylev3.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&family=Roboto+Slab:wght@100;300;500;600;800&display=swap" rel="stylesheet">

    <style>
        .form-select {
            background-color: #EFEFEF;
            border-radius: 8px;
            border: 1px solid #EAE9F0;
        }
        .form-control, textarea, .ck-editor{
            background-color: #EFEFEF;
            border-radius: 8px;
            border: 1px solid #EAE9F0;
            color: rgba(24, 19, 43, 0.63);

        }
        .ck.ck-editor__main>.ck-editor__editable:not(.ck-focused){
            background-color: #EFEFEF;
        }
    </style>
</head>   
<!-- <body class="bg-white"> -->
<body class="">
<div class="page-wraper">
    
    <!-- Fixd Header -->
    <div class="fixedheader">
        <!-- Header -->
        <header class="header header-type2">
            <div class="main-bar5">
                <div class="container">
                    <div class="header-content">
                        <div class="left-content  w-auto">
                            <a href="javascript:void(0);" class="d-block d-flex align-items-center">
                                <img class="back-btn" src="../assets/icons/leftarrow.png" style="width:8px;height:16px;" /> 
                                <span class="fw-bold mx-3">Edit Inputs for Sale</span>
                            </a>
                            <br/><br/>
                        </div>
                        <div class="mid-content">
                        </div>
                        <div class="right-content">
                            <!-- <img src="../assets/icons/bell.png" onclick="location.assign('/dashboard/notification.html')" /> -->
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Header End -->
        
        <!-- Preloader -->
        <!-- <div id="preloader">
            <div class="spinner"></div>
        </div> -->
        <!-- Preloader end-->
    </div>
    <!-- Fixd Header -->
    
    <!-- Preloader -->
	<!-- <div id="preloader">
		<div class="spinner"></div>
	</div> -->
    <!-- Preloader end-->
    
	<!-- Sidebar -->
    <div class="sidebar" id="sidebar">
		
    </div>
    <!-- Sidebar End -->
    
    <!-- Banner -->
	<div class="author-notification">
		<div class="container inner-wrapper">
			
				
		</div>
	</div>
    <!-- Banner End -->

    
    <!-- Page Content -->
    <div id="main" class="container page-content bottom-content ">
         <!-- Banner -->
         <!-- <div class="dashboard-banner-wrapper">
            <div class="circle-1"></div>
            <div class="container inner-wrapper">
                <div class="dz-title">       
                    <img src="../logos/fertilizer.png" width="100px" class="brand-title text-white mt-2"/>
                    <h4 class="title text-white mb-3">Add Input for Sale</h4>
                </div>
              
            </div>
        </div> -->
        <!-- Banner End -->
        
        <div class="account-box">
            <div class="container">
                <div class="account-area">

                    <!-- <script src="../assets/js/jquery.js"></script>
                    <script>
                        
                            

                            $('#formimage').submit(function(e){
                           
                                e.preventDefault();
                                console.log(filesToUpload," console.log(filesToUpload);");
                                //Store form Data
                                var formData = new FormData();
                                //Loop through array of file and append form Data
                                for (var i = 0; i < filesToUpload.length; i++) {
                                    var file = filesToUpload[i];
                                    var filename = filesToUpload[i].name;
                                    formData.append("image"+i, file, filename);
                                }

                                // console.log(formData, " formData");

                            })
                    </script> -->
					
                    <!-- ---------------------------- FORM SLIDE 1 ----------------------------- -->
                    <form class="form" id="editInputForm">
                        <p aria-hidden="true" id="required-description">
                            <span class="required"><strong>*</strong></span> Required field
                        </p>

                        <!-- Form 1A -->

                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Product type <span class="required">*</span></label>
                            <!-- <input name="inputproducttype" type="text" class="form-control" required  style="border:1px solid #ced4da;" /> -->
                            <select class="form-select" id="inputproducttype" name="inputproducttype" required="">
                                <!-- <option value="">--Select Subcategory--</option> -->
                                <option value="">--Select Product type--</option>
                                <option value="Hybrid">Hybrid</option>
                                <option value="Normal">Normal</option>
                                <option value="Organic">Organic</option>
                                <option value="GMO">GMO</option>
                            </select>
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Catalog <span class="required">*</span></label>
                            <select class="form-select" required="" id="category" >
                                <option value="">--Select category--</option>
                            </select>
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Product <span class="required">*</span></label>
                            <select class="form-select" required="" aria-label="Default select example" id="subcategory" >
                                <option value="">--Select Subcategory--</option>
                            </select>
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Price <span class="required">*</span></label>
                            <input name="inputtitle" type="text" class="form-control" required id="inputprice" style="border:1px solid #ced4da;" />
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Input Crop focus <span><i>(Optional)</i></span></label>
                            <select class="form-select" id="inputcropfocus" name="inputtitle">
                                <!-- <option value="">--Select Subcategory--</option> -->
                                <option value="">--Select Crop Focus--</option>
                                <option value="Grains">Grains</option>
                                <option value="Cash Crops">Cash Crops</option>
                            </select>
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Packaging <span class="required">*</span></label>
                            <!-- <input name="inputtitle" type="text" class="form-control" required id="inputpackaging" style="border:1px solid #ced4da;" /> -->
                            <select class="form-select" id="inputpackaging" name="inputtitle" required="">
                                <option value="">--Select Packaging--</option>
                                <option value="Bag">Bag</option>
                                <option value="Bottles">Bottles</option>
                                <option value="Sachet">Sachet</option>
                                <option value="Carbon">Carbon</option>
                            </select>
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Liters(1-50) <span class="required">*</span></label>
                            <!-- <input name="inputtitle" type="number" min="1" max="50" class="form-control" required id="inputliters" style="border:1px solid #ced4da;" /> -->
                            <select class="form-select ponetofiftypercent" min="1" max="50" id="inputliters" required>
                                
                            </select>
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Kilograms(5-50) <span class="required">*</span></label>
                            <!-- <input name="inputtitle" type="number" min="1" max="50" class="form-control" required id="inputkg" style="border:1px solid #ced4da;" /> -->
                            <select class="form-select ponetofiftypercent" min="1" max="50" id="inputkg" required>
                                
                            </select>
                        </div>
                        <!-- <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Grams(5-50) <span class="required">*</span></label>
                            <input name="inputtitle" type="number" min="1" max="50" class="form-control" id="inputgram" style="border:1px solid #ced4da;" />
                        </div> -->
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Stock (Quantity) <span class="required">*</span></label>
                            <input name="inputstock" type="text" class="form-control" required id="inputstock" style="border:1px solid #ced4da;" />
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Delivery method <span class="required">*</span></label>
                            <select class="form-select" required="" aria-label="Default select example" id="inputdeliverymethod" >
                                <option value="">--Select Shipping Method--</option>
                                <option value="Delivery">Delivery</option>
                                <option value="Pick up at Crop Center">Pick up at Crop Center</option>
                            </select>
                        </div>
                        <!-- <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Input Application <span class="required">*</span></label>
                            <input name="inputtitle" type="text" class="form-control" required id="inputapplication" style="border:1px solid #ced4da;" />
                        </div> -->
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Currency<span class="required">*</span></label>
                            <select class="form-select" required="" aria-label="Default select example" id="currency" >
                                <option value="NGN">NGN</option>
                            </select>
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Manufacturer Name <span class="required">*</span></label>
                            <input name="manufacturername" type="text" class="form-control" required id="manufacturername" style="border:1px solid #ced4da;" />
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Manufacturer Date <span class="required">*</span></label>
                            <input name="manufacturerdate" type="date" class="form-control" required id="manufacturerdate" style="border:1px solid #ced4da;" />
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Expiring Date <span class="required">*</span></label>
                            <input name="expiringdate" type="date" class="form-control" required id="expiringdate" style="border:1px solid #ced4da;" />
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label mb-0">Manufacture Country <span class="required">*</span></label>
                            <select class="form-select" required="" id="countryList" aria-label="Default select example" >
                                
                            </select>
                        </div>
                        <!-- <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label mb-0">Manufacture State <span class="required">*</span></label>
                            <select class="form-select" id="stateList" aria-label="Default select example" >
                                <option value="">- Select state -</option>
                                
                            </select>
                        </div> -->
                        <!-- FORM 1A -->


                        <!-- FORM 1B -->
                        <div class="upload__box">
                            <div class="w-100 mb-3">
                                <label for="exampleInputEmail1" class="form-label mb-0">Product image (maximum of 1) <span class="required">*</span></label>
                               
                                <input type="hidden" id="DBimagesToEdit" />

                                <span class="text-primary d-block" id="noimageUploadedResponse"><i>No new image uploaded yet</i></span>
                                <div class="upload__img-wrap py-2" id="images-for-edit-preview"></div>

                                <div class="upload__btn-box">
                                    <label class="upload__btn py-2">
                                        <p style="margin:0px;color:#7e7e7e;" class="fw-bold">
                                            <img src="../assets/icons/carbon_add-filled.png" />
                                            <br/>
                                            Upload images +
                                        </p>
                                        <input type="file"
                                        id="cropimages" data-max_length="4" class="upload__inputfile" accept="image/png, image/jpg, image/jpeg">
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="w-100 mb-3">
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Video URL <span>(Optional)</span></label>
                            <input name="inputtitle" type="text" class="form-control" id="videourl" style="border:1px solid #ced4da;" />
                        </div>
                        <div class="w-100 editor-wrapper">
                            <input type="hidden" id="inputDescriptionHidden" />
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Quality description <span class="required">*</span></label>
                            <textarea name="cropdescription" id="editor"></textarea>
                        </div>
                        <div class="w-100 editor-wrapper">
                            <input type="hidden" id="inputUsageInstructionHidden" />
                            <label for="exampleInputEmail1" class="form-label text-dark mb-0 lh-28 fw-700">Usage instruction <span class="required">*</span></label>
                            <textarea name="cropdescription" id="usageinstruction"></textarea>
                        </div>
                                                
                        <div id="form_slide1_response"></div>
                        <!-- FORM 1B -->


                        <div class="input-group">
                            <button type="submit" class="btn mt-2 btn-success w-100 btn-rounded">Save</button>
                        </div>

                    </form>
                    <!-- ---------------------------- FORM SLIDE 1 ----------------------------- -->


                </div>
            </div>
        </div>
    </div>
    <!-- Page Content End-->




    <!-- ------------------------------- LOADER -------------------------------- -->
    <div class="loader">
        
    </div>
    <!-- ------------------------------- LOADER -------------------------------- -->


    <!-- ------------------------------- MODAL -------------------------------- -->
    <div class="mymodal">
        
    </div>
    <!-- ------------------------------- MODAL -------------------------------- -->


	
</div>  
<!--**********************************
    Scripts
***********************************-->
<script src="../assets/js/jquery.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="../assets/vendor/swiper/swiper-bundle.min.js"></script><!-- Swiper -->
<script src="../assets/js/dz.carousel.js"></script><!-- Swiper -->
<script src="../assets/vendor/imageuplodify/imageuploadify.min.js"></script>
<script src="../assets/vendor/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script><!-- Swiper -->
<script src="../assets/js/settings.js"></script>
<script src="../assets/js/custom.js"></script>
<script src="https://cdn.ckeditor.com/ckeditor5/35.4.0/classic/ckeditor.js"></script>
<script src="../assets/js/modal.js"></script>
<script src="../assets/js/plugins/country-state-array.js"></script>
<script src="../assets/js/countrylist.js"></script>
<script src="../assets/lib/pulltorefresh.js"></script>
<script src="../assets/js/env.js"></script> 
<script src="../assets/js/dashboard.js"></script>




<script src="../index.js" defer></script>
<script>
    $(".stepper").TouchSpin();
</script>
<script>
    sidemenu();
    populateUserDetails();
    fetchInputCategories();
    fetchInputFocus();
    populateCountryList();
    // addInputPage();
    setTimeout(()=>{
        populateSingleInputDetails();
    },1000)
    setTimeout(()=>{
        addInputPage();
        populateSingleInputDetails();
    },2000)
</script>

<script>
    var myClassicEditor1, myClassicEditor2;
    ClassicEditor.create( document.querySelector( '#editor' ) )
        .then(editor => {
            myClassicEditor1 = editor;
            // Insert HTML content into the CKEditor instance
            // myClassicEditor.setData('<p>This is <strong>HTML</strong> content.</p>');
            $(document).ready(()=>{
                setTimeout(()=>{
                    let inputDescriptionHidden = $('#inputDescriptionHidden').val();
                    console.log("inputDescriptionHidden ",inputDescriptionHidden);
                    myClassicEditor1.setData(inputDescriptionHidden);
                },2000)
            })
        })
        .catch( error => {
            console.error( error );
        } );

    ClassicEditor.create( document.querySelector( '#usageinstruction' ) )
        .then(editor => {
            myClassicEditor2 = editor;
            // Insert HTML content into the CKEditor instance
            // myClassicEditor.setData('<p>This is <strong>HTML</strong> content.</p>');
            $(document).ready(()=>{
                setTimeout(()=>{
                    let inputUsageInstructionHidden = $('#inputUsageInstructionHidden').val();
                    // console.log("inputUsageInstructionHidden ",inputUsageInstructionHidden);
                    myClassicEditor2.setData(inputUsageInstructionHidden);
                },2000)
            })
        })
        .catch( error => {
            console.error( error );
        } );



    
    
    $(document).ready(function(){
        // COUNT FOR SELECT
        let emptyoption = `<option value=""></option>`;
        let rowContent = "";
        for(let i=1; i<=50; i++){
            rowContent += `
                <option value="${i}">${i}%</option>
            `;   
        }
        $('.ponetofiftypercent').html(emptyoption + rowContent);
        // COUNT FOR SELECT
    });

    // <!-- ---------------------------- IMAGE UPLOAD ----------------------------- -->
    let globalImageArrayLength = 0;

    jQuery(document).ready(function () {
        ImgUpload();
    });

    function ImgUpload() {
        var imgWrap = "";
        var imgArray = [];

        $('.upload__inputfile').each(function () {
            $(this).on('change', function (e) {
                // alert("vr");
                const divElement = document.getElementById('images-for-edit-preview');
                const elementsWithClassCount = divElement.getElementsByClassName('upload__img-box').length;
                console.log("elementsWithClassCount ", elementsWithClassCount);
                if(elementsWithClassCount>0){
                    basicmodal("","Maximum required number of image is 1");
                    return false;
                }
                imgWrap = $(this).closest('.upload__box').find('.upload__img-wrap');
                var maxLength = $(this).attr('data-max_length');

                var files = e.target.files;
                var filesArr = Array.prototype.slice.call(files);
                console.log("filesArr", filesArr);
                var iterator = 0;
                filesArr.forEach(function (f, index) {

                    if (!f.type.match('image.*')) {
                        return;
                    }
                    // console.log("imgArray.length",imgArray.length);
                    // console.log("maxLength",maxLength);
                    if (imgArray.length > maxLength) {
                        return false
                    } else {
                        var len = 0;
                        for (var i = 0; i < imgArray.length; i++) {
                            if (imgArray[i] !== undefined) {
                            len++;
                            }
                        }
                        if (len > maxLength) {
                            return false;
                        } else {
                            imgArray.push(f);

                            console.log(imgArray, " image Array");
                            globalImageArrayLength = imgArray.length;
                            var reader = new FileReader();
                            reader.onload = function (e) {
                            var html = "<div class='upload__img-box'><div style='background-image: url(" + e.target.result + ")' data-number='" + $(".upload__img-close").length + "' data-file='" + f.name + "' class='img-bg'><div class='upload__img-close'></div></div></div>";
                            imgWrap.append(html);
                            iterator++;
                            }
                            reader.readAsDataURL(f);
                        }
                    }
                });

                console.log("globalImageArrayLength ", globalImageArrayLength);
                if(globalImageArrayLength==0){
                    $('#noimageUploadedResponse').removeClass('d-none').addClass('d-block');
                }else{
                    $('#noimageUploadedResponse').removeClass('d-block').addClass('d-none');
                }
            });
        });

        $('body').on('click', ".upload__img-close", function (e) {
           // console.log(this.id);
           let cancelbuttonID = this.id;
            let productImgNumber = cancelbuttonID.replace('close', '');

            // :begin IF IT WAS IMAGE FROM DB
            let DBimagesToEdit = $('#DBimagesToEdit').val();
            if(DBimagesToEdit){
                // Split the string into an array
                let DBimagesToEditArray = DBimagesToEdit.split(",");

                // Img URL to remove
                var backgroundImageUrl = $('.upload__img-box #thebgImage'+productImgNumber+'').css('background-image');
                console.log("backgroundImageUrl ", backgroundImageUrl);
                let urlToRemove = backgroundImageUrl.replace('url("', '').replace('")', '');
                urlToRemove = urlToRemove.toString();
                console.log("urlToRemove ",urlToRemove);

                // Remove the desired URL from the array
                DBimagesToEditArray = DBimagesToEditArray.filter(url => url !== urlToRemove);

                // Join the array back into a string
                DBimagesToEdit = DBimagesToEditArray.join(",");
                console.log("Final DBimagesToEdit ", DBimagesToEdit);

                $('#DBimagesToEdit').val(DBimagesToEdit);
            }
            // :end IF IT WAS IMAGE FROM DB

            var file = $(this).parent().data("file");
            console.log("the file to be deleted", file);
            for (var i = 0; i < imgArray.length; i++) {
                if (imgArray[i].name === file) {
                    imgArray.splice(i, 1);
                    break;
                }
            }
            console.log(imgArray, " image Array After Delete");
            globalImageArrayLength = imgArray.length;
            $(this).parent().parent().remove();

            if(globalImageArrayLength==0){
                $('#noimageUploadedResponse').removeClass('d-none').addClass('d-block');
            }else{
                $('#noimageUploadedResponse').removeClass('d-block').addClass('d-none');
            }
        });
        
    }
    // <!-- ---------------------------- IMAGE UPLOAD ----------------------------- -->




    // <!-- ------------------------------ ADD INPUT ------------------------------ -->
    // Add input files to array
    var inputfilesToUpload = [];

    //On Change loop through all file and push to array[]
    $('#inputimages').on('change', function(e) {
        // alert(this.files.length);
        for (var i = 0; i < this.files.length; i++) {
            inputfilesToUpload.push(this.files[i]);
        }
        console.log(inputfilesToUpload);
    });


    const timeoutDuration = 20000; // Timeout duration in milliseconds

    const timeoutPromise = new Promise((resolve, reject) => {
        setTimeout(() => {
            // reject(new Error('Request timeout'));
            EndPageLoader();
            console.log("", "Service timed out");
        }, timeoutDuration);
    });

    const fetchDataWithTimeout = (url, options) => {
        const fetchDataPromise = fetch(url, options);

        return Promise.race([fetchDataPromise, timeoutPromise]);
    };


    $('#editInputForm').submit(function(e){
        e.preventDefault();

        console.log(inputfilesToUpload," console.log(inputfilesToUpload);");

        // alert($('#editor').val());
        let form_slide1_response = document.getElementById('form_slide1_response');
        let cropdescription = document.getElementById('editor');

     

        // if(inputfilesToUpload.length < 1){
        //     form_slide1_response.innerHTML = `<span class="text-danger"><i>* Input image is needed</i></span>`;
        // }else 
        if(cropdescription.value==""||cropdescription.value===null){
            form_slide1_response.innerHTML = `<span class="text-danger"><i>* Enter crop description</i></span>`;
        }else if(usageinstruction.value==""||usageinstruction.value===null){
            form_slide1_response.innerHTML = `<span class="text-danger"><i>* Enter usage instructions</i></span>`;
        }else{
            // Grab all the ids
            let category = document.getElementById('category');
            let subcategory = document.getElementById('subcategory');
            let inputprice = document.getElementById('inputprice');
            let inputpackaging = document.getElementById('inputpackaging');
            let inputproducttype = document.getElementById('inputproducttype');
            let inputcropfocus = document.getElementById('inputcropfocus');
            let inputliters = document.getElementById('inputliters');
            let inputkg = document.getElementById('inputkg');
            // let inputgram = document.getElementById('inputgram');
            let inputstock = document.getElementById('inputstock');
            let countryList = document.getElementById('countryList');
            // let stateList = document.getElementById('stateList');
            let inputdeliverymethod = document.getElementById('inputdeliverymethod');
            let videourl = document.getElementById('videourl');
            let currency = document.getElementById('currency');
            let manufacturername = document.getElementById('manufacturername');
            let manufacturerdate = document.getElementById('manufacturerdate');
            let expiringdate = document.getElementById('expiringdate');
            let editor = document.getElementById('editor');
            let usageinstruction = document.getElementById('usageinstruction');
            // let fileuploaded = $('#inputimages').prop('files')[0];
            // console.log(fileuploaded, "fileuploaded");

            var form = new FormData();
            form.append("user_id", user.user.id);
            form.append("category_id", category.value);
            form.append("subcategory_id", subcategory.value);
            form.append("product_type", inputproducttype.value);
            form.append("crop_focus", inputcropfocus.value);
            form.append("packaging", inputpackaging.value);
            form.append("description", editor.value);
            form.append("stock", inputstock.value);
            form.append("usage_instruction", usageinstruction.value);
            form.append("kilograms", inputkg.value);
            // form.append("grams", inputgram.value);
            form.append("liters", inputliters.value);
            form.append("price", inputprice.value);
            form.append("currency", currency.value);
            form.append("manufacture_name", manufacturername.value);
            form.append("manufacture_date", manufacturerdate.value);
            form.append("delivery_method", inputdeliverymethod.value);
            form.append("expiry_date", expiringdate.value);
            form.append("manufacture_country", countryList.value);
            // form.append("state", stateList.value);
            form.append("video", videourl.value);

            // form.append("front", fileuploaded, "cornproduct_resize.jpg");
            // form.append("image2", fileInput.files[0], "maizethumbnail_resized.jpg");

            console.log("globalImageArrayLength",globalImageArrayLength);
            // cropimages.files.length
            
                
            // startPageLoader();
            let img, index=0; 
            var fd = new FormData(); 
            console.log(inputfilesToUpload, "The Input Image Array to Upload");

            const activePage = window.location.pathname;

            let imgArr = [];
            //Loop through array of file and append formData Data
            for (var i = 0; i < inputfilesToUpload.length; i++) {
                var file = inputfilesToUpload[i];
                var filename = inputfilesToUpload[i].name;
                // formData.append("image"+i, file, filename);
                imgArr.push(file);
            }

            const divElement = document.getElementById('images-for-edit-preview');
            const elementsWithClassCount = divElement.getElementsByClassName('upload__img-box').length;
            console.log("elementsWithClassCount ", elementsWithClassCount);
            if (elementsWithClassCount < 1) {
                basicmodal("", "Please enter at least 1 images");
                return;
            }
            if(elementsWithClassCount>1){
                basicmodal("","Maximum required number of images must be 1");
                return;
            }

            // FOR INPUT EDIT PAGE
            let allDBEditImages = [];
            if(activePage.includes('/edit')){
                let DBimagesToEditList = $('#DBimagesToEdit').val();

                // If there is no newly added image uploaded for edit
                if(imgArr.length==0){
                    allDBEditImages.push(DBimagesToEditList);
                    form.append("images", allDBEditImages);

                    console.log(form, "The final formData");
                    let input_id = localStorage.getItem('singleInputID');

                    var settings = {
                        "url": `${liveMobileUrl}/input/edit/${input_id}`,"method": "POST", "timeout": 20000,
                        "headers": {// "Content-Type": "application/json",
                            "authorization": localStorage.getItem('authToken')
                        },
                        "processData": false, "mimeType": "multipart/form-data", "contentType": false, 
                        "data": form,

                        // Using error property within settings
                        error: function (xhr, textStatus, errorMessage) {
                            console.error(errorMessage);
                            // Error callback
                            console.error(errorMessage);
                            EndPageLoader();
                            $('.loader').addClass('loader-hidden');
                            if(textStatus==="timeout") {
                                basicmodal("", "Service timed out");
                            } else {
                                // alert(textstatus);
                                basicmodal("", textStatus);
                            }
                        }
                    };

                    $.ajax(settings).done(function (data) {
                        // console.log(data);
                        let response = JSON.parse(data);
                        EndPageLoader();
                        if(response.error == true){
                            responsemodal("erroricon.png", "Error", response.message);
                            // responsefullmodal("erroricon.png", response.message, "", "");
                        }else{
                            $('.dialogbox').addClass('d-none');
                            $('.dialogbox').removeClass('d-block');

                            let goto;
                            goto = '/dashboard/viewuseraddedinput.html';
                            responsefullmodal("successicon2.png", "Input Edited", "", goto);
                        }
                    })
                }

                // If there is a newly added image uploaded for edit
                if(imgArr.length>0){
                    // If there's still a value inside DBimagesToEditList hidden input
                    if(DBimagesToEditList){
                        allDBEditImages.push(DBimagesToEditList);
                        // formData.append("images", allDBEditImages);
                    }

                    
                    let crop_id = localStorage.getItem('singleproductID');

                    // Start of image upload to fileServer
                    let allimages = [];
                    let imagecompleted;
                    for (var i = 0; i < imgArr.length; i++) {
                        var file = imgArr[i];
                        var filename = imgArr[i].name;
                        // form.append("image"+i, file, filename);
                        index = i+1;
                
                        fd = new FormData(); 
                        // fd.append( 'file', input.files[0] );
                        
                        startPageLoader();
                        fd.append("image", file);
                        fetchDataWithTimeout('https://filesapi.growsel.com/upload.php', {method: 'POST',body: fd}).then(response => response.json())
                        .then(data => {
                            // console.log("Chima", data);
                            if(data.error == false){
                                img = data.data.imageLink;
                                console.log(img, "img"+index);
                            }
                            allimages.push(img);
                            if(allimages.length==imgArr.length){
                                imagecompleted = true;
                
                                console.log(index, "Image completed");
                                // Carry the One remaining in the hidden input DB Images and append the newly added ones
                                allDBEditImages.push(allimages);
                                form.append("images", allDBEditImages);
                
                                console.log(form, "The final formData");
                                
                                let serverURL;
                                let input_id = localStorage.getItem('singleInputID');
                                serverURL = `${liveMobileUrl}/input/edit/${input_id}`;
                
                                var settings = {
                                    "url": `${serverURL}`,
                                    "method": "POST",
                                    "timeout": 20000,
                                    "headers": {
                                        // "Content-Type": "application/json",
                                        "authorization": localStorage.getItem('authToken')
                                    },
                                    "processData": false,
                                    "mimeType": "multipart/form-data",
                                    "contentType": false,
                                    "data": form,
                
                                    // Using error property within settings
                                    error: function (xhr, textStatus, errorMessage) {
                                        console.error(errorMessage);
                                        // Error callback
                                        console.error(errorMessage);
                                        EndPageLoader();
                                        $('.loader').addClass('loader-hidden');
                                        if(textStatus==="timeout") {
                                            basicmodal("", "Service timed out");
                                        } else {
                                            // alert(textstatus);
                                            basicmodal("", textStatus);
                                        }
                                    }
                                };
                
                                $.ajax(settings).done(function (data) {
                                    // console.log(data);
                                    let response = JSON.parse(data);
                                    EndPageLoader();
                                    if(response.error == true){
                                        // alert(response.message);
                                        // responsefullmodal(icon, title, body, page)
                                        responsemodal("erroricon.png", "Error", response.message);
                                        // responsefullmodal("erroricon.png", response.message, "", "");
                                    }else{
                                        // responsemodal("successicon.png", "Success", response.message);
                                            // $("#editInputForm")[0].reset();
                                            $('.dialogbox').addClass('d-none');
                                            $('.dialogbox').removeClass('d-block');
                                            let goto;
                                            goto = '/dashboard/viewuseraddedinput.html';
                                            responsefullmodal("successicon2.png", "Input Edited", "", goto);
                                        
                                    }
                                })
                                
                                /* ------------------------------ // FORM DATA ------------------------------ */
                            }
                        }).catch((error) => {
                            // Handle error
                            console.error('An error occurred:', error);
                        });
                    }
                    // End of image upload to fileServer
                }
            }else{

            }
        }

    })

    // <!-- ------------------------------ ADD INPUT ------------------------------ -->
    
</script>


</body>
</html>