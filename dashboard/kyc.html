<!DOCTYPE html>
<html lang="en">
    <head>
    <script type="text/javascript"  src="../assets/js/accessauthentication_dashboard.js"></script>
	<!-- Meta -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, minimal-ui, viewport-fit=cover">
	<meta name="theme-color" content="#2196f3">
	<meta name="author" content="DexignZone" /> 
    <meta name="keywords" content="" /> 
    <meta name="robots" content="" /> 
	<meta name="description" content="Zowasel"/>
	<meta property="og:title" content="Zowasel" />
	<meta property="og:description" content="Zowasel" />
	<meta property="og:image" content="https://makaanlelo.com/tf_products_007/foodia/xhtml/social-image.png"/>
	<meta name="format-detection" content="telephone=no">
	
    <!-- Favicons Icon -->
	<link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon.png" />
    
    <!-- Title -->
	<title>Zowasel Mobile</title>
	
	<!-- PWA Version -->
	<link rel="manifest" href="manifest.json">
    
    <!-- Stylesheets -->
	<link rel="stylesheet" href="../assets/vendor/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.css">
    <link rel="stylesheet" href="../assets/vendor/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/style.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/style2.css">
    <link rel="stylesheet" type="text/css" href="../bypass.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&family=Roboto+Slab:wght@100;300;500;600;800&display=swap" rel="stylesheet">
    
     <!--
        Ideally these elements aren't created until it's confirmed that the 
        client supports video/camera, but for the sake of illustrating the 
        elements involved, they are created with markup (not JavaScript)
    -->
    <!-- SNAP -->
    <style>
        video  {
        /* width: 192px;
        height: 192px; */
        background: rgba(0,0,0,0.2);
        /* -webkit-transform: scaleX(-1); mirror effect while using front cam */
        /* transform: scaleX(-1);         mirror effect while using front cam */
        }

        #canvas-IDFront  {
        /* width: 192px; */
        /* height: 192px; */
        /* -webkit-transform: scaleX(-1);mirror effect while using front cam */
        /* transform: scaleX(-1);         mirror effect while using front cam */
        }
        .cameraBorder{
            background: #FFFFFF;
            border: 3px dashed rgba(0, 0, 0, 0.51);
            border-radius: 21px;
        }
        .captureBorder{
            background: #FFFFFF;
            border: 3px dashed rgba(0, 0, 0, 0.51);
            border-radius: 21px;
        }
        .idFrontOutput,.idBackOutput{
            display: none;
            text-align: center;
        }
    </style>

</head>   
<body class="bg-white">
<div class="page-wraper">
    
    <!-- Header -->
    <header class="header">
        <div class="main-bar">
            <div class="container">
                <div class="header-content">
                    <div class="left-content">
                        <a href="wallet.html">
                            <svg width="18" height="18" viewBox="0 0 10 16" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path d="M9.03033 0.46967C9.2966 0.735936 9.3208 1.1526 9.10295 1.44621L9.03033 1.53033L2.561 8L9.03033 14.4697C9.2966 14.7359 9.3208 15.1526 9.10295 15.4462L9.03033 15.5303C8.76406 15.7966 8.3474 15.8208 8.05379 15.6029L7.96967 15.5303L0.96967 8.53033C0.703403 8.26406 0.679197 7.8474 0.897052 7.55379L0.96967 7.46967L7.96967 0.46967C8.26256 0.176777 8.73744 0.176777 9.03033 0.46967Z" fill="#a19fa8"/>
							</svg>
                        </a>
                        <h5 class="mb-0 ms-2">Kyc Verification</h5>
                    </div>
                    <div class="mid-content">
                    </div>
                    <div class="right-content">
                        <button class="btn verificationStatus">Unverified</button>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Header End -->
    
    <!-- Preloader -->
	<!-- <div id="preloader">
		<div class="spinner"></div>
	</div> -->
    <!-- Preloader end-->
    
	<!-- Sidebar -->
    <div class="sidebar" id="sidebar">
		
    </div>
    <!-- Sidebar End -->
    
   
    <!-- Banner -->
	<!-- <div class="author-notification">
		<div class="container inner-wrapper">
			
				
		</div>
	</div> -->
    <!-- Banner End -->

    
    <!-- Page Content -->
    <div id="main" class="page-content bottom-content" style="background: #f7f7f7;height:93vh;">
        <div class="container">

            <!-- row -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="kyccard" id="idTypeandNumberSection">
                        <div class="card-body">
							<form id="idTypeandNumber">
                                <label style="color:#2c2646d1;font-weight:700;">Type</label>
								<div class="mb-3 input-group">
									<span class="input-group-text"><i class="fas fa-money-check"></i></span>
									<select required id="driverlicence" class="form-control">
                                        <option value="">Select ID Type</option>
                                        <option value="driverlicence">Drivers Licence</option>
                                    </select>
								</div>

                                <label style="color:#2c2646d1;font-weight:700;">Id Number</label>
								<div class="mb-3 input-group">
									<!-- <span class="input-group-text"><i class="fas fa-hashtag"></i></span> -->
									<input required id="idnumber" class="form-control" />
								</div>
								<div class="text-center">
                                    <button type="submit" class="btn btn-dark mt-3 ">Next</button>
                                </div>
							</form>
						</div>
                    </div>

                    <!-- ID FRONT -->
                    <div class="kyccard" id="frontIDSection" style="display: none;position:relative;">
                        
                        <div class="card-body">
							<div class="idUploadFormHolder">
                                <label style="color:#2c2646d1;font-weight:700;" class="text-center d-block">ID Front</label>
                                <span style="color:#2c2646d1;font-weight:700;font-size:12px;" class="text-center d-block">Please snap the front of your Selected id</span>
								
                                <!-- Camera -->
                                <div class="container">
                                    <div class="">
                                      <video id="camera-stream-IDFront" autoplay muted playsinline class="cameraBorder w-100">Not available</video>
                                    </div>
                                    <div class="text-center">
                                      <button disabled id="flip-btn-IDFront" class="btn btn-sm btn-warning">
                                        Flip Camera
                                      </button>
                                      <button id="capture-camera-IDFront" class="btn btn-sm btn-primary">
                                        Take photo
                                      </button>
                                    </div>
                                    <div class="mt-3 idFrontOutput">
                                      <b>Output:</b>
                                      <br>
                                      <canvas id="canvas-IDFront" style="display:none" class="bg-light shadow border border-5 border-success">
                                      </canvas>
                                      <img id="photo-IDFront" class="captureBorder w-100" alt="The screen capture will appear in this box."> 
                                    </div>
                                  </div>
                                <!-- SNAP -->

								<div class="text-center">
                                    <button type="button" class="btn btn-dark mt-3" onclick="gobacktoSection(`idTypeandNumberSection`)">Prev</button>
                                    <button type="button" id="frontIDNextBtn" class="btn btn-dark mt-3 ">Next</button>
                                </div>
							</div>
						</div>
                    </div>

                    <!-- ID BACK -->
                    <div class="kyccard" id="backIDSection" style="display: none;position:relative;">

                        <div class="card-body">
							<div id="payForm">
                                <label style="color:#2c2646d1;font-weight:700;" class="text-center d-block">ID Back</label>
                                <span style="color:#2c2646d1;font-weight:700;font-size:12px;" class="text-center d-block">Please snap the back of your Selected id</span>
								
                                <!-- Camera -->
                                <div class="container">
                                    <div class="">
                                      <video id="camera-stream-IDBack" autoplay muted playsinline class="cameraBorder w-100">Not available</video>
                                    </div>
                                    <div class="text-center">
                                      <button disabled id="flip-btn-IDBack" class="btn btn-sm btn-warning">
                                        Flip Camera
                                      </button>
                                      <button id="capture-camera-IDBack" class="btn btn-sm btn-primary">
                                        Take photo
                                      </button>
                                    </div>
                                    <div class="mt-3 idBackOutput">
                                      <b>Output:</b>
                                      <br>
                                      <canvas id="canvas-IDBack" style="display:none" class="bg-light shadow border border-5 border-success">
                                      </canvas>
                                      <img id="photo-IDBack" class="captureBorder w-100" alt="The screen capture will appear in this box."> 
                                    </div>
                                  </div>
                                <!-- SNAP -->

								<div class="text-center">
                                    <button type="button" class="btn btn-dark mt-3" onclick="gobacktoSection(`frontIDSection`)">Prev</button>
                                    <button type="button" id="backIDNextBtn" class="btn btn-dark mt-3 ">Next</button>
                                </div>
							</div>
						</div>
                    </div>

                    <!-- PREVIEW UPLOADED DOCUMENT -->
                    <div class="kyccard" id="idPreviewSection" style="display: none;position:relative;">

                        <div class="card-body">
							<div id="payForm">
                                <label style="color:#2c2646d1;font-weight:700;">Type</label>
								<div class="mb-3 input-group">
									<span class="input-group-text"><i class="fas fa-money-check"></i></span>
									<input type="text" readonly required id="driverlicence-v" class="form-control">
								</div>

                                <label style="color:#2c2646d1;font-weight:700;">Id Number</label>
								<div class="mb-3 input-group">
									<!-- <span class="input-group-text"><i class="fas fa-hashtag"></i></span> -->
									<input required readonly id="idnumber-v" class="form-control" />
								</div>

                                <!-- ID FRONT -->
                                <label style="color:#2c2646d1;font-weight:700;" class="text-center d-block">ID Front</label>
                                <img id="photo-IDFront-v" class="captureBorder w-100" alt="The screen capture will appear in this box.">

                                <!-- ID BACK -->
                                <label style="color:#2c2646d1;font-weight:700;" class="text-center d-block mt-2">ID Back</label>
                                <img id="photo-IDBack-v" class="captureBorder w-100" alt="The screen capture will appear in this box.">

								<div class="text-center">
                                    <button type="button" class="btn border border-dark mt-3" onclick="gobacktoSection(`idTypeandNumberSection`)">Edit</button>
                                    <button type="button" id="backIDNextBtn" class="btn btn-dark mt-3 ">Submit</button>
                                </div>
							</div>
						</div>
                    </div>


                </div>
            </div>
            <!-- row -->

        </div>

    </div>
    <!-- Page Content End-->



    <!-- ------------------------------- LOADER -------------------------------- -->
    <div class="loader">
        
    </div>
    <!-- ------------------------------- LOADER -------------------------------- -->


    <!-- ------------------------------- MODAL -------------------------------- -->
    <div class="mymodal">
        
    </div>
    <!-- ------------------------------- MODAL -------------------------------- -->


	
</div>  
<!--**********************************
    Scripts
***********************************-->
<script src="../assets/js/jquery.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="../assets/vendor/swiper/swiper-bundle.min.js"></script><!-- Swiper -->
<script src="../assets/js/dz.carousel.js"></script><!-- Swiper -->
<script src="../assets/vendor/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script><!-- Swiper -->
<script src="../assets/js/settings.js"></script>
<script src="../assets/js/custom.js"></script>
<script src="../assets/js/modal.js"></script>
<script src="https://checkout.flutterwave.com/v3.js"></script>
<script src="../assets/lib/pulltorefresh.js"></script>
<script src="../assets/js/env.js"></script> 
<script src="../assets/js/dashboard.js"></script>



<script src="../index.js" defer></script>
<script>
    $(".stepper").TouchSpin();
</script>
<script>
    // sidemenu();
    // populateUserDetails();
    fundWalletPage();
</script>

<script>
    $(document).ready(()=>{
       
        // camera stream video element
        let on_stream_video = document.querySelector('#camera-stream-IDFront');
        let on_stream_video2 = document.querySelector('#camera-stream-IDBack');
        // flip button element
        let flipBtn = document.querySelector('#flip-btn-IDFront');
        let flipBtn2 = document.querySelector('#flip-btn-IDBack');

        // default user media options
        let constraints = { audio: false, video: true }
        let shouldFaceUser = false;
        // let shouldFaceUser2 = false;

        // check whether we can use facingMode
        let supports = navigator.mediaDevices.getSupportedConstraints();
        if( supports['facingMode'] === true ) {
            flipBtn.disabled = false;
            flipBtn2.disabled = false;
        }

        let stream = null;
        let stream2 = null;

        function capture1() {
            constraints.video = {
                width: {
                    min: 192,
                    ideal: 192,
                    max: 192,
                },
                height: {
                    min: 192,
                    ideal: 192,
                    max: 192
                },
                facingMode: shouldFaceUser ? 'environment' : 'environment'
            }
            navigator.mediaDevices.getUserMedia(constraints)
            .then(function(mediaStream) {
                console.log(mediaStream, "mediaStream");
                stream  = mediaStream;
                on_stream_video.srcObject = stream;
                on_stream_video.play();
            })
            .catch(function(err) {
                console.log(err)
            });

            navigator.mediaDevices.getUserMedia(constraints)
            .then(function(mediaStream) {
                console.log(mediaStream, "mediaStream2");
                
                stream2  = mediaStream;
                on_stream_video2.srcObject = stream2;
                on_stream_video2.play();
            })
            .catch(function(err) {
                console.log(err)
            });
        }

        // function capture2() {
        //     constraints.video = {
        //         width: {
        //             min: 192,
        //             ideal: 192,
        //             max: 192,
        //         },
        //         height: {
        //             min: 192,
        //             ideal: 192,
        //             max: 192
        //         },
        //         facingMode: shouldFaceUser ? 'environment' : 'environment'
        //     }
        //     navigator.mediaDevices.getUserMedia(constraints)
        //     .then(function(mediaStream) {
        //         console.log(mediaStream, "mediaStream");
                
        //         stream2  = mediaStream;
        //         on_stream_video2.srcObject = stream2;
        //         on_stream_video2.play();
        //     })
        //     .catch(function(err) {
        //         console.log(err)
        //     });
        // }

        // flipBtn.addEventListener('click', function(){
        //     if( stream == null ) return
        //     // we need to flip, stop everything
        //     stream.getTracks().forEach(t => {
        //     t.stop();
        //     });
        //     // toggle / flip
        //     shouldFaceUser = !shouldFaceUser;
        //     capture1();
        //     on_stream_video.play();
        // })
        
        capture1();

        // <!-- ----------------------------- flip Btn 2 ------------------------------ -->
        flipBtn2.addEventListener('click', function(){
            if( stream2 == null ) return
            // we need to flip, stop everything
            stream2.getTracks().forEach(t => {
            t.stop();
            });
            // toggle / flip
            shouldFaceUser2 = !shouldFaceUser2;
            capture1();
            on_stream_video2.play();
        })
        

        document.getElementById("capture-camera-IDFront").addEventListener("click", function() {
            // Elements for taking the snapshot
            const video = document.querySelectorAll('video')[0];
            // canvas.width = video.videoWidth;
            // canvas.height = video.videoHeight;
            // canvas.getContext('2d').drawImage(video, 0, 0);
            // alert("Yes");

            let canvas = document.getElementById('canvas-IDFront');
            let photo = document.getElementById('photo-IDFront');  
            let photo_v = document.getElementById('photo-IDFront-v');  
            let context = canvas.getContext('2d');
            
            const height = video.videoHeight;
            const width = video.videoWidth;
            
            if (width && height) {    
                canvas.width = width;
                canvas.height = height;
                context.drawImage(video, 0, 0, width, height);    
                var data = canvas.toDataURL('image/png');
                photo.setAttribute('src', data);
                photo_v.setAttribute('src', data);

                $('.idFrontOutput').show();
                // on_stream_video.pause();
                on_stream_video.play();
            } else {
                clearphoto();
            }
        });



        // BackOutput
        document.getElementById("capture-camera-IDBack").addEventListener("click", function() {
            // Elements for taking the snapshot
            const video = document.querySelectorAll('video')[1];
            // canvas.width = video.videoWidth;
            // canvas.height = video.videoHeight;
            // canvas.getContext('2d').drawImage(video, 0, 0);
            // alert("Big boy");

            let canvas = document.getElementById('canvas-IDBack');
            let photo = document.getElementById('photo-IDBack');  
            let photo_v = document.getElementById('photo-IDBack-v');  
            let context = canvas.getContext('2d');
            
            const height = video.videoHeight;
            const width = video.videoWidth;
            
            if (width && height) {    
                canvas.width = width;
                canvas.height = height;
                context.drawImage(video, 0, 0, width, height);    
                var data = canvas.toDataURL('image/png');
                photo.setAttribute('src', data);
                photo_v.setAttribute('src', data);

                $('.idBackOutput').show();
                // on_stream_video2.pause();
                on_stream_video2.play();
            } else {
                clearphoto();
            }
        });







        // SWITCH PAGE SECTIONS 
        $('#idTypeandNumber').submit(function(e){
            e.preventDefault();
            $('#idTypeandNumberSection').hide();
            $('#frontIDSection').show();
        })
        $('#frontIDNextBtn').on('click',function(e){
            e.preventDefault();
            $('#frontIDSection').hide();
            $('#backIDSection').show();
        })
        $('#backIDNextBtn').on('click',function(e){
            e.preventDefault();
            let driverlicence = document.getElementById('driverlicence').value;
            let idnumber = document.getElementById('idnumber').value;
            $('#driverlicence-v').val(driverlicence);
            $('#idnumber-v').val(idnumber);
            $('#backIDSection').hide();
            $('#idPreviewSection').show();
        })
        // SWITCH PAGE SECTIONS
    })

    // GO BACK TO PREVIOUS SECTION
    function gobacktoSection(n){
        // alert(n);
        $('.kyccard').hide();
        $(`#${n}`).show();
    }
    // GO BACK TO PREVIOUS SECTION
</script>

</body>
</html>