<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- Meta -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, minimal-ui, viewport-fit=cover">
	<meta name="theme-color" content="#2196f3">
	<meta name="author" content="DexignZone" /> 
    <meta name="keywords" content="" /> 
    <meta name="robots" content="" /> 
	<meta name="description" content="Zowasel"/>
	<meta property="og:title" content="Zowasel" />
	<meta property="og:description" content="Zowasel" />
	<meta property="og:image" content="https://zowasel.com/images/logos/white%20logo.png"/>
	<meta name="format-detection" content="telephone=no">
    
    <!-- Favicons Icon -->
	<link rel="shortcut icon" type="image/x-icon" href="./logos/zowaselICO512by512.png" />
    
    <!-- Title -->
	<title>Zowasel Mobile Web</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="assets/vendor/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <link rel="stylesheet" type="text/css" href="assets/css/style2.css">
    <link rel="stylesheet" type="text/css" href="assets/css/font.css">  
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&family=Roboto+Slab:wght@100;300;500;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="bypass.css"/>
    <script src="./assets/js/accessauthentication_onboarding.js"></script>

    <style>
        .form-input-general{
            background: #EFEFEF !important;
            font-family: 'DM Sans' !important;
            font-style: normal !important;
            font-weight: 500 !important;
            font-size: 14px !important;
            line-height: 28px !important;
            color: rgba(44, 38, 70, 0.63) !important;
            padding-left: 10px !important;
        }
        .form-input-noicon{
            border-radius: 8px !important;
            border: 1px solid #EAE9F0 !important;
        }
        .form-input-righticon{
            border-top-right-radius: 0px !important;
            border-bottom-right-radius: 0px !important;
            border: 1px 0 1px 1px solid #EAE9F0 !important;
        }
        .show-pass{
            border-top-right-radius: 8px !important;
            border-bottom-right-radius: 8px !important;
        }
    </style>

</head>   
<body class="bg-white">
<div class="page-wraper">

    <!-- Preloader -->
	<!-- <div id="preloader">
		<div class="spinner"></div>
	</div> -->
    <!-- Preloader end-->

    <!-- Page Content -->
    <div id="main" class="page-content">
        
        <!-- Banner -->
        <!-- <div class="banner-wrapper">
            <div class="circle-1"></div>
            <div class="container inner-wrapper">
                <h1 class="dz-title">       <img src="logos/logo.png" width="180px" class="brand-title text-white mt-2"/>
                </h1>
              
            </div>
        </div> -->
        <!-- Banner End -->
        <div class="account-box-new">
            <div class="container">
                <div class="account-area">
                    <div class="container inner-wrapper text-center mb-2">
                        <h1 class="dz-title">       
                            <img src="logos/zowasel-grey-logo.png" width="179px" height="62px" class="brand-title text-white mt-2"/>
                        </h1>
                    </div>

                    <div class="fontFamily1 fw-600s f-23 zowasel-notthickdark-color mt-4">Create Password</div>
                    <p class="fontFamily1">Set-up a unique password to login to your account</p>
					<form>
						<div class="mb-3 input-group input-mini">
							<span class="input-group-text"><i class="fa fa-lock"></i></span>
							<input type="password" id="password" class="form-control dz-password" placeholder="Create Password">
							<span class="input-group-text show-pass"> 
								<i class="fa fa-eye-slash"></i>
								<i class="fa fa-eye"></i>
							</span>
						</div>

                        <div class="mb-3 input-group input-mini">
							<span class="input-group-text"><i class="fa fa-lock"></i></span>
							<input type="password" id="confirmPassword" class="form-control dz-password" placeholder="Confirm Password">
							<span class="input-group-text show-pass"> 
								<i class="fa fa-eye-slash"></i>
								<i class="fa fa-eye"></i>
							</span>
						</div>

                        <p class="incorrectMsg">Passwords do not match!</p>

                        <!--  -->
                        <div class="pswd_info">
                            <h4 class="pswd_reqs">Password must meet the following requirements:</h4>
                            <ul>
                              <li id='letter' class='invalid'>Contains <strong>a lowercase letter</strong></li>
                        
                              <li id='capital' class='invalid'>Contains <strong>a capital letter</strong></li>
                        
                              <li id='number' class='invalid'>Contains <strong>a number</strong></li>
                        
                              <li id='special' class='invalid'>Contains <strong>a special character</strong></li>
                        
                              <li id='length' class='invalid'>Contains <strong>8 characters</strong></li>
                            </ul>
                          </div>
                        <!--  -->




						<div class="input-group">
							<a onclick="createPassword()" class="btn mt-2 btn-success w-100 btn-rounded">SIGN UP</a>
						</div>
						<!-- <div class="d-flex justify-content-between align-items-center">
						
							<a href="#" class="btn-link text-dark">Forgot password?</a>
						</div> -->
					</form>  
                    <div class="text-center mt-3 fontFamily1 f-15 lh-25">
                        <span class="saprate text-dark" style="display: contents;">
                            Donâ€™t have an account? <a href="signup.html" class="d-inline zowasel-color">Sign up</a>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Page Content End -->
    
    <!-- Footer -->
    <!-- <footer class="footer fixed">
        <div class="container">
            <a href="signup.html" class="btn btn-transparent btn-rounded d-block">CREATE AN ACCOUNT</a>
        </div>
    </footer> -->
    <!-- Footer End -->


    <!-- ------------------------------- LOADER -------------------------------- -->
    <div class="loader">
        
    </div>
    <!-- ------------------------------- LOADER -------------------------------- -->


    <!-- ------------------------------- MODAL -------------------------------- -->
    <div class="mymodal">
        
    </div>
    <!-- ------------------------------- MODAL -------------------------------- -->
    
  
</div>
<!--**********************************
    Scripts
***********************************-->
<script src="assets/js/jquery.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/js/settings.js"></script>
<script src="assets/js/custom.js"></script>
<script src="./assets/js/env.js"></script> 
<script src="./assets/js/onboarding.js"></script> 
<script src="assets/js/modal.js"></script>
<script>
    createpasswordPage();

    // CLICK SUBMIT PASSWORD BUTTON
    const createPassword =()=>{
        // alert("erf");
        let password = document.getElementById('password');
        let password2 = document.getElementById('confirmPassword');
        if(password.value !== password2.value) {
            $('.incorrectMsg').show();
            $('#confirmPassword').addClass('shake invalidPass')
            password2.blur(function() {
            // (triggers whenever the password field is unselected)
                $('#confirmPassword').trigger('reset');
                $('.incorrectMsg').hide();
                $('#confirmPassword').removeClass('shake').removeClass('invalidPass');
            });
        } else {
            $('#confirmPassword').trigger('reset');
            $('.incorrectMsg').hide();
            $('#confirmPassword').removeClass('shake').removeClass('invalidPass');

            var pswd = password.value;
            if(pswd.length >= 8 && pswd.match(/[a-z]/) && pswd.match(/[A-Z]/) && pswd.match(/\d/) && pswd.match(/[$&+,:;=?@#|'<>.^*()%!-]/) ) {
                // alert("Good to go");
                $('.incorrectMsg').hide();
                $('.incorrectMsg').html('Passwords do not match!');


                /********* DB CONNECTION **********/                
                let registerData = localStorage.getItem('registerData');
                let otpemail = JSON.parse(registerData).email;
                let user_type = localStorage.getItem('userType');
                // console.log(registerData, "registerData");
                // console.log(otpemail, "otpemail");
                // console.log(pswd, "pswd");
                // console.log(user_type, "user_type");
                
                let account_type = localStorage.getItem('account_type');
                let thedata;
                if(account_type=="individual"){
                    thedata = {
                        "email": otpemail,
                        "first_name": JSON.parse(registerData).first_name,
                        "last_name": JSON.parse(registerData).last_name,
                        "password": pswd,
                        "phone": JSON.parse(registerData).phone,
                        "user_type": user_type
                    }
                }else if(account_type=="company"){
                    thedata = {
                        "email": otpemail,
                        "first_name": JSON.parse(registerData).first_name,
                        "last_name": JSON.parse(registerData).last_name,
                        "password": pswd,
                        "phone": JSON.parse(registerData).phone,
                        "user_type": user_type,
                        "has_company": 1,
                        "company_name" : JSON.parse(registerData).company_name,
                        "company_address" : JSON.parse(registerData).company_address,
                        "company_country" : "Nigeria",
                        "company_state" : JSON.parse(registerData).company_state,
                        "rc_number" : JSON.parse(registerData).rc_number,
                        "company_email" : JSON.parse(registerData).company_email,
                        "company_phone" : JSON.parse(registerData).company_phone
                    }

                    if(user_type=="agent"){
                        thedata["agent_type"] = "usermanagement";
                        delete thedata["has_company"];
                    }
                }
                console.log(thedata);

                startPageLoader();

                let registerRoute;
                if(user_type=="agent"){
                    registerRoute = "register/agent";
                }else{
                    registerRoute = "register";
                }
                $.ajax({
                    "url": `${liveBaseUrl}/${registerRoute}`,
                    "method": "POST",
                    "timeout": 25000,
                    "headers": {
                        "Content-Type": "application/json"
                    },
                    "data": JSON.stringify(thedata),
                    success: function(response) { 
                        EndPageLoader();
                        // console.log(response,"Create Password Response");
                        if(response.error == true || response.error == 'true'){
                            // alert(response.message);
                            // alert("An error occured! Please ensure this account has not been registered before");
                            // responsemodal("erroricon.png", "Error", "An error occured! Please ensure this account has not been registered before");
                            responsemodal("erroricon.png", "Error", response.message);
                        }else{
                            // alert(response.message);
                            responsemodal("successicon.png", "Success", "Registration Completed");   
                            // localStorage.setItem('authToken', response.token)
                            setTimeout(() => {
                                location.href="login.html";
                                // alert("Go to dashboard");
                            }, 2000); 
                        }
                    },
                    error: function(xmlhttprequest, textstatus, message) {
                        EndPageLoader();
                        // console.log(xmlhttprequest, "Error code");
                        if(textstatus==="timeout") {
                            basicmodal("", "Service timed out <br/>Check your internet connection");
                        }
                    },
                    statusCode: {
                        200: function(response) {
                            console.log('ajax.statusCode: 200');
                        },
                        400: function(response) {
                            console.log('ajax.statusCode: 400');
                            // console.log(response);
                            responsemodal("erroricon.png", "Error", response.responseJSON.message);
                        },
                        403: function(response) {
                            console.log('ajax.statusCode: 403');
                            basicmodal("", "Session has ended, Login again");
                            setTimeout(()=>{
                                logout();
                            },3000)
                        },
                        404: function(response) {
                            console.log('ajax.statusCode: 404');
                        },
                        500: function(response) {
                            console.log('ajax.statusCode: 500');
                        }
                    }
                })
                /********* DB CONNECTION **********/

            }else{
                $('.incorrectMsg').show();
                $('.incorrectMsg').html('Invalid password');
                $('.pswd_info').fadeIn('slow');
            }
        } 
    }
    // CLICK SUBMIT PASSWORD BUTTON

</script>
</body>
</html>